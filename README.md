# 项目发布及自动化部署工具 (Upload Tool)

## 工具概述
这是一个集发布包上传、自动化部署、运行日志查看于一体的内部管理工具。

### 核心功能
1. **中转式安全上传**：开发人员将包上传至中转服务器 (1.50 Windows)，控制台自动分发至目标 Linux 测试机。开发人员无法直连目标机。
2. **多模块支持**：针对微服务架构，支持前端及后台 (`gateway`, `system`, `infra`, `eng`) 模块的独立发布。
3. **级联备份策略**：
   - **1.50 服务器**：保留最近 **7 天** 的历史发布包。
   - **目标服务器**：保留最近 **3 天** 的备份包，支持自动滚动清理。
4. **非破坏性部署**：采用“安全重命名”机制，替换包时重命名旧版本而非直接删除，确保秒级回滚。
5. **实时日志穿透**：通过控制台 UI 实时 tail 目标 Linux 服务器上的运行日志。

### 技术架构
- **控制台中枢**: 基于 Next.js，部署于 1.50 Windows，作为唯一安全跳转中心。
- **目标环境**: 华为云等 Linux 测试服务器。
- **配置存储**: MySQL (包含 **AES 加密存储** 的服务器 SSH 凭证)。
- **通讯协议**: SSH/SCP (用于自动化执行及分发)。

### 控制台功能
- **用户认证**: JWT 会话管理，支持登录/登出。
- **用户管理**: 用户 CRUD，角色分配（admin/developer/viewer）。
- **权限控制**: 基于项目的部署权限管理（RBAC）。
- **动态仪表盘**: 实时展示项目数量、模块总数、部署环境、今日发布次数等统计。
- **项目配置管理**: 左侧 Tab 菜单 + 右侧内容的布局，支持部署环境和项目模块的 CRUD。
- **侧边栏导航**: 带图标的菜单项，自动高亮当前页面。
- **实时日志**: 通过 SSE 推送远程服务器的 `tail -f` 日志流。
- **手动服务控制**: 支持独立重启和停止服务，无需重新部署。
- **部署日志分类**: 自动区分发包部署、服务重启、服务停止三种操作类型。
- **部署历史查询**: 支持按项目、模块、服务器、状态、操作类型等多维度筛选。

### 部署流程
`上传 (1.50) -> 归档 (1.50 7天) -> 分发 (B节点) -> 安全更名备份 (B节点 3天) -> 包替换与重启 -> 健康检查`